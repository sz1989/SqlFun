/*
select *
from otherEarnings
where id in( 60503859,60503864,60503866,60503860,60503861,60503858,60503865,60503862,60503863,60503857,60503760,60503867,60503552,60503553,60503868,60503869,60503870,60503871,60503872,60503873)
*/

select distinct(AccountingMonth)
from OtherEarnings
order by 1

select distinct(AccountingMonth)
from OtherEarnings
where datepart(DW, AccountingMonth) in (1, 7)
order by 1 desc

select *
from OtherEarnings
where id = 20000513
and KindId = 3

--'60503858|01/31/2017|3','60503859|01/31/2017|3','60503860|01/31/2017|3','60503861|01/31/2017|3','60503864|01/31/2017|3','60503867|01/31/2017|3','60503552|01/31/2017|3','60503553|01/31/2017|3','60503868|01/31/2017|3','60503869|01/31/2017|3','60503870|01/31/2017|3','60503871|01/31/2017|3','60503872|01/31/2017|3','60503873|01/31/2017|3','60503858|02/28/2017|3','60503859|02/28/2017|3','60503860|02/28/2017|3','60503861|02/28/2017|3','60503864|02/28/2017|3','60503867|02/28/2017|3','60503552|02/28/2017|3','60503553|02/28/2017|3','60503868|02/28/2017|3','60503869|02/28/2017|3','60503870|02/28/2017|3','60503871|02/28/2017|3','60503872|02/28/2017|3','60503873|02/28/2017|3','60503858|03/31/2017|3','60503859|03/31/2017|3','60503860|03/31/2017|3','60503861|03/31/2017|3','60503864|03/31/2017|3','60503867|03/31/2017|3','60503552|03/31/2017|3','60503553|03/31/2017|3','60503868|03/31/2017|3','60503869|03/31/2017|3','60503870|03/31/2017|3','60503871|03/31/2017|3','60503872|03/31/2017|3','60503873|03/31/2017|3','60503858|04/30/2017|3','60503859|04/30/2017|3','60503860|04/30/2017|3','60503861|04/30/2017|3','60503864|04/30/2017|3','60503867|04/30/2017|3','60503552|04/30/2017|3','60503553|04/30/2017|3','60503868|04/30/2017|3','60503869|04/30/2017|3','60503870|04/30/2017|3','60503871|04/30/2017|3','60503872|04/30/2017|3','60503873|04/30/2017|3','60503858|05/31/2017|3','60503859|05/31/2017|3','60503860|05/31/2017|3','60503861|05/31/2017|3','60503864|05/31/2017|3','60503867|05/31/2017|3','60503552|05/31/2017|3','60503553|05/31/2017|3','60503868|05/31/2017|3','60503869|05/31/2017|3','60503870|05/31/2017|3','60503871|05/31/2017|3','60503872|05/31/2017|3','60503873|05/31/2017|3'}	

-- (60503858,'01/31/2017',3),(60503859,'01/31/2017',3),(60503860,'01/31/2017',3),(60503861,'01/31/2017',3),(60503864,'01/31/2017',3),(60503867,'01/31/2017',3),(60503552,'01/31/2017',3),(60503553,'01/31/2017',3),(60503868,'01/31/2017',3),(60503869,'01/31/2017',3),(60503870,'01/31/2017',3),(60503871,'01/31/2017',3),(60503872,'01/31/2017',3),(60503873,'01/31/2017',3),(60503858,'02/28/2017',3),(60503859,'02/28/2017',3),(60503860,'02/28/2017',3),(60503861,'02/28/2017',3),(60503864,'02/28/2017',3),(60503867,'02/28/2017',3),(60503552,'02/28/2017',3),(60503553,'02/28/2017',3),(60503868,'02/28/2017',3),(60503869,'02/28/2017',3),(60503870,'02/28/2017',3),(60503871,'02/28/2017',3),(60503872,'02/28/2017',3),(60503873,'02/28/2017',3),(60503858,'03/31/2017',3),(60503859,'03/31/2017',3),(60503860,'03/31/2017',3),(60503861,'03/31/2017',3),(60503864,'03/31/2017',3),(60503867,'03/31/2017',3),(60503552,'03/31/2017',3),(60503553,'03/31/2017',3),(60503868,'03/31/2017',3),(60503869,'03/31/2017',3),(60503870,'03/31/2017',3),(60503871,'03/31/2017',3),(60503872,'03/31/2017',3),(60503873,'03/31/2017',3),(60503858,'04/30/2017',3),(60503859,'04/30/2017',3),(60503860,'04/30/2017',3),(60503861,'04/30/2017',3),(60503864,'04/30/2017',3),(60503867,'04/30/2017',3),(60503552,'04/30/2017',3),(60503553,'04/30/2017',3),(60503868,'04/30/2017',3),(60503869,'04/30/2017',3),(60503870,'04/30/2017',3),(60503871,'04/30/2017',3),(60503872,'04/30/2017',3),(60503873,'04/30/2017',3),(60503858,'05/31/2017',3),(60503859,'05/31/2017',3),(60503860,'05/31/2017',3),(60503861,'05/31/2017',3),(60503864,'05/31/2017',3),(60503867,'05/31/2017',3),(60503552,'05/31/2017',3),(60503553,'05/31/2017',3),(60503868,'05/31/2017',3),(60503869,'05/31/2017',3),(60503870,'05/31/2017',3),(60503871,'05/31/2017',3),(60503872,'05/31/2017',3),(60503873,'05/31/2017',3)

/*
DECLARE @t TABLE ([Id] [bigint] NOT NULL, [AccountingMonth] [date] NOT NULL, [KindId] [bigint] NOT NULL);
INSERT INTO @t VALUES (60503858,'01/31/2017',3),(60503859,'01/31/2017',3),(60503860,'01/31/2017',3),(60503861,'01/31/2017',3),(60503864,'01/31/2017',3),(60503867,'01/31/2017',3),(60503552,'01/31/2017',3),(60503553,'01/31/2017',3),(60503868,'01/31/2017',3),(60503869,'01/31/2017',3),(60503870,'01/31/2017',3),(60503871,'01/31/2017',3),(60503872,'01/31/2017',3),(60503873,'01/31/2017',3),(60503858,'02/28/2017',3),(60503859,'02/28/2017',3),(60503860,'02/28/2017',3),(60503861,'02/28/2017',3),(60503864,'02/28/2017',3),(60503867,'02/28/2017',3),(60503552,'02/28/2017',3),(60503553,'02/28/2017',3),(60503868,'02/28/2017',3),(60503869,'02/28/2017',3),(60503870,'02/28/2017',3),(60503871,'02/28/2017',3),(60503872,'02/28/2017',3),(60503873,'02/28/2017',3),(60503858,'03/31/2017',3),(60503859,'03/31/2017',3),(60503860,'03/31/2017',3),(60503861,'03/31/2017',3),(60503864,'03/31/2017',3),(60503867,'03/31/2017',3),(60503552,'03/31/2017',3),(60503553,'03/31/2017',3),(60503868,'03/31/2017',3),(60503869,'03/31/2017',3),(60503870,'03/31/2017',3),(60503871,'03/31/2017',3),(60503872,'03/31/2017',3),(60503873,'03/31/2017',3),(60503858,'04/30/2017',3),(60503859,'04/30/2017',3),(60503860,'04/30/2017',3),(60503861,'04/30/2017',3),(60503864,'04/30/2017',3),(60503867,'04/30/2017',3),(60503552,'04/30/2017',3),(60503553,'04/30/2017',3),(60503868,'04/30/2017',3),(60503869,'04/30/2017',3),(60503870,'04/30/2017',3),(60503871,'04/30/2017',3),(60503872,'04/30/2017',3),(60503873,'04/30/2017',3),(60503858,'05/31/2017',3),(60503859,'05/31/2017',3),(60503860,'05/31/2017',3),(60503861,'05/31/2017',3),(60503864,'05/31/2017',3),(60503867,'05/31/2017',3),(60503552,'05/31/2017',3),(60503553,'05/31/2017',3),(60503868,'05/31/2017',3),(60503869,'05/31/2017',3),(60503870,'05/31/2017',3),(60503871,'05/31/2017',3),(60503872,'05/31/2017',3),(60503873,'05/31/2017',3);

DELETE e FROM OtherEarnings e JOIN @t t ON e.Id = t.Id AND e.AccountingMonth = t.AccountingMonth AND e.KindId = t.KindId
--SELECT * FROM OtherEarnings e JOIN @t t ON e.Id = t.Id AND e.AccountingMonth = t.AccountingMonth AND e.KindId = t.KindId


select *
from OtherEarnings
where id = 60503552
*/

/* SQL on Oracle Side
select bp.trans_adj_p_gaap, bp.f_pgaap_earned,bp.f_pgaap_bal,bp.bop_pgaap, b.record_date, b.boba_k, rs."stream_no" 
from 
    abob_user.das_reins_struc_s rs,
    abob_user.abob_tbl_corp_gig g,
    abob_user.abob_tbl_segment s,
    abob_user.abob_tbl_boba b, 
    abob_user.abob_tbl_boba_premium bp
where
    rs."stream_no" in (60503858,60503859,60503860,60503861,60503864,60503867,60503552,60503553,60503868,60503869,60503870,60503871,60503872,60503873)
    and 
    b.record_date >= To_date('1/1/2017', 'MM/DD/YYYY') and b.record_date < To_date('6/1/2017', 'MM/DD/YYYY')  --:   adDate and -- could also use acct_yr and month fields
    and rs."gig_k" = g.corp_gig_k and
    b.inter_side = 'C' and -- ceded record.  We are only populating the ceded side
    bp.usd = 'T' and  -- pgaap only goes on USD record.  Not local
    g.corp_gig_k = s.corp_gig_k and
    s.segment_k = b.segment_k and
    b.boba_k = bp.boba_k and
    Nvl(bp.f_gaap_upr,0) <> 0
*/